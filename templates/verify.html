{% extends "base.html" %}
{% set active_page = 'verify' %}

{% block title %}Verify Certificate – CertifyMe{% endblock %}

{% block page_header %}
<div class="mt-3">
  <div class="page-kicker">Public verification</div>
  <h2 class="page-title mb-1">Check if a certificate is real.</h2>
  <p class="page-subtitle mb-0">
    Paste a CertifyMe certificate ID, verification URL or hash. We’ll validate it against
    the original record.
  </p>
</div>
{% endblock %}

{% block content %}
<div class="row g-3">
  <div class="col-lg-5">
    <div class="card-soft h-100">
      <form method="post" action="{{ url_for('verify_certificate') }}">
        <div class="mb-2">
          <label class="field-label">Certificate ID / URL / hash</label>
          <input
            type="text"
            name="query"
            class="form-control"
            placeholder="e.g. CFT-2024-ABCD1234"
            required
          >
        </div>
        <button class="btn btn-primary-pill mt-2 w-100" type="submit">
          Verify certificate
        </button>
      </form>
      <p class="small-muted mt-3 mb-0">
        Verification is read-only and auditable. We never change issued certificates here.
      </p>
    </div>
  </div>

  <div class="col-lg-7">
    <div class="card-soft h-100 d-flex flex-column">
      {% if result %}
        {% if result.valid %}
          <div class="d-flex justify-content-between align-items-start mb-2">
            <div>
              <span class="chip chip--accent mb-2">
                <span class="status-dot status-dot--ok"></span>
                Certificate verified
              </span>
              <div class="fw-semibold fs-5">{{ result.student_name }}</div>
              <div class="small-muted">{{ result.course }}</div>
            </div>
            <div class="text-end small-muted">
              <div>ID: <code>{{ result.certificate_id }}</code></div>
              <div>Issued: {{ result.issued_at }}</div>
            </div>
          </div>
          <hr class="border-secondary border-opacity-50">
          <div class="row small-muted">
            <div class="col-md-6 mb-2">
              <div class="field-label">Issued by</div>
              <div>{{ result.teacher_name }} • {{ result.institute_name }}</div>
            </div>
            <div class="col-md-3 mb-2">
              <div class="field-label">Status</div>
              <span class="status-pill status-pill--ok">
                <span class="status-dot status-dot--ok"></span>
                Active
              </span>
            </div>
            <div class="col-md-3 mb-2">
              <div class="field-label">Score / Grade</div>
              <div>{{ result.score or 'Not specified' }}</div>
            </div>
          </div>
        {% else %}
          <div class="d-flex flex-column align-items-center justify-content-center text-center h-100">
            <span class="chip chip--danger mb-2">
              <span class="status-dot status-dot--pending"></span>
              Not found or revoked
            </span>
            <p class="small-muted mb-1">
              We couldn’t match this certificate to an active record.
            </p>
            <p class="small-muted mb-0">
              Check the ID or contact the issuing institute directly.
            </p>
          </div>
        {% endif %}
      {% else %}
        <div class="d-flex flex-column align-items-center justify-content-center text-center h-100 small-muted">
          <p class="mb-1">Submit a certificate query to see results here.</p>
          <p class="mb-0">Only CertifyMe-issued credentials are supported.</p>
        </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
